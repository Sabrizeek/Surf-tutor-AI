{"id":"log_1766498122758_a","timestamp":1766498122759,"location":"routes/sessions.js:8","message":"sessionController loaded","data":{"hasSessionController":true,"keys":["saveSession","getUserSessions","getSession","getSessionStats"],"hasSaveSession":true},"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"id":"log_1766498122760_b","timestamp":1766498122760,"location":"routes/sessions.js:9","message":"authenticateToken loaded","data":{"hasAuthenticateToken":"undefined","authenticateTokenType":"undefined","authenticateTokenValue":"undefined"},"sessionId":"debug-session","runId":"run1","hypothesisId":"A"}
{"id":"log_1766498122760_c","timestamp":1766498122760,"location":"routes/sessions.js:23","message":"Before route registration","data":{"authenticateTokenType":"undefined","authenticateTokenDefined":false,"saveSessionType":"function","saveSessionDefined":true},"sessionId":"debug-session","runId":"run1","hypothesisId":"A,B,C"}
{"id":"log_1766498165225_a","timestamp":1766498165225,"location":"routes/sessions.js:8","message":"sessionController loaded","data":{"hasSessionController":true,"keys":["saveSession","getUserSessions","getSession","getSessionStats"],"hasSaveSession":true},"sessionId":"debug-session","runId":"run1","hypothesisId":"B"}
{"id":"log_1766498165226_b","timestamp":1766498165226,"location":"routes/sessions.js:9","message":"authMiddleware loaded","data":{"hasAuthMiddleware":"function","authMiddlewareType":"function","authMiddlewareValue":"function authMiddleware(req, res, next) {\r\n  const auth = req.headers.authorization;\r\n  \r\n  if (!auth) {\r\n    console.log('[auth] Missing authorization header');\r\n    return res.status(401).json({ error: 'missing auth' });\r\n  }\r\n  \r\n  const parts = auth.split(' ');\r\n  if (parts.length !== 2 || parts[0] !== 'Bearer') {\r\n    console.log('[auth] Bad auth header format');\r\n    return res.status(401).json({ error: 'bad auth header' });\r\n  }\r\n  \r\n  try {\r\n    const payload = jwt.verify(parts[1], JWT_SECRET);\r\n    console.log('[auth] Token verified successfully, user id:', payload.id);\r\n    req.user = payload;\r\n    next();\r\n  } catch (err) {\r\n    console.error('[auth] Token verification failed:', err.message);\r\n    return res.status(401).json({ error: 'invalid token', details: err.message });\r\n  }\r\n}"},"sessionId":"debug-session","runId":"run2","hypothesisId":"A"}
{"id":"log_1766498165226_c","timestamp":1766498165226,"location":"routes/sessions.js:23","message":"Before route registration","data":{"authMiddlewareType":"function","authMiddlewareDefined":true,"saveSessionType":"function","saveSessionDefined":true},"sessionId":"debug-session","runId":"run2","hypothesisId":"A,B,C"}
